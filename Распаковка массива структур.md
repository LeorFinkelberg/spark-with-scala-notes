Если схема кадра данных показывает, что атрибут имеет тип массива структур, то есть что-то вроде
```bash
|-- corwId: map(nullable = true)
|    |-- key: string
|    |-- value: integer = true)
|-- shows: array (nullable = true)  # <- NB!
|     |-- element: struct (containsNull = true)
|          |-- timestamp: long (nullable = true)
|          |-- showMillis: long (nullable = true)
|-- clicks: array (nullable = true)
|    |-- element: struct (containsNull = true)
|    |    |-- timestamp: long (nullable = true)
```
то развернуть элементы массива в столбцы можно так
```scala
import org.apache.spark.sql.functions._

df.withColumn(
  "shows",
  explode(col("shows"))  // NB!
)
.select(
  "*",
  "shows.*"  // Передать нужно обязательно строку, а не Col-объект!!!
)
```

Тогда на выходе получим таблицу с таким заголовком
```bash
userId | platform | ... | shows | clicks | timestamp | showMillis |
```