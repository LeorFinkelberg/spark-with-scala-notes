### Выбрать столбцы кадра данных по регулярному выражению

```scala
val columnRegex = """%.*Origin$""".r

df.select(
  df.columns.filter(
    columnRegex.findFirstIn(_).isDefined
).map(col): _*)
```

### Динамический выбор функции агреграции
```scala
import org.apache.spark.sql.functions._

def getAggregate(
  input: DataFrame,
  aggName: String,
): DataFrame = {
  input.select(
    input.columns.map(
      c => call_udf(aggName, col(c))
    ): _*
  )
}
```